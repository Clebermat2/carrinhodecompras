<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Atividade: Carrinho de Compras Inteligente</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .item-card {
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .item-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }
        .dragging {
            opacity: 0.5;
            border: 2px dashed #4f46e5;
        }
        .drop-zone {
            transition: background-color 0.3s, border-color 0.3s;
        }
        .drag-over {
            background-color: #e0e7ff;
            border-color: #4f46e5;
        }
        .item-in-cart {
            cursor: not-allowed;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">

    <div class="container mx-auto p-4 md:p-8">
        
        <!-- Cabe√ßalho -->
        <header class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-slate-900">Carrinho de Compras Inteligente</h1>
            <p class="text-slate-600 mt-2 max-w-2xl mx-auto">Arraste os itens da lista de necessidades para os carrinhos corretos (Custeio ou Capital) sem estourar os or√ßamentos, com base nas regras do PDDE.</p>
        </header>

        <!-- Painel de Or√ßamentos -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
            <div class="bg-white p-6 rounded-xl shadow-md border border-slate-200 text-center">
                <h2 class="text-lg font-bold text-blue-600">OR√áAMENTO DE CUSTEIO</h2>
                <p class="text-3xl font-bold text-slate-800 mt-2" id="orcamento-custeio">R$ 2.000,00</p>
                <p class="text-sm text-slate-500">Para material de consumo e servi√ßos.</p>
            </div>
            <div class="bg-white p-6 rounded-xl shadow-md border border-slate-200 text-center">
                <h2 class="text-lg font-bold text-green-600">OR√áAMENTO DE CAPITAL</h2>
                <p class="text-3xl font-bold text-slate-800 mt-2" id="orcamento-capital">R$ 3.000,00</p>
                <p class="text-sm text-slate-500">Para equipamentos e material permanente.</p>
            </div>
        </div>

        <!-- √Årea Principal: Itens e Carrinhos -->
        <main class="grid grid-cols-1 lg:grid-cols-3 gap-8">

            <!-- Coluna de Itens Dispon√≠veis -->
            <div class="lg:col-span-1 bg-white p-6 rounded-xl shadow-lg border border-slate-200">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-bold">Lista de Necessidades</h2>
                    <button id="reset-button" class="text-sm bg-indigo-600 text-white font-semibold py-2 px-4 rounded-lg hover:bg-indigo-700 transition-colors">
                        Reiniciar
                    </button>
                </div>
                <div id="itens-disponiveis" class="space-y-4 h-[600px] overflow-y-auto p-2 bg-slate-50 rounded-lg">
                    <!-- Itens ser√£o inseridos aqui pelo JavaScript -->
                </div>
            </div>

            <!-- Coluna dos Carrinhos -->
            <div class="lg:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-8">
                
                <!-- Carrinho de Custeio -->
                <div id="carrinho-custeio" data-tipo="custeio" class="drop-zone bg-white p-6 rounded-xl shadow-lg border-2 border-dashed border-slate-300">
                    <h2 class="text-xl font-bold text-center text-blue-600 mb-4">üõí Carrinho de Custeio</h2>
                    <div id="custeio-items" class="min-h-[200px] space-y-3">
                        <p class="text-center text-slate-400">Arraste os itens de custeio para c√°.</p>
                    </div>
                </div>

                <!-- Carrinho de Capital -->
                <div id="carrinho-capital" data-tipo="capital" class="drop-zone bg-white p-6 rounded-xl shadow-lg border-2 border-dashed border-slate-300">
                    <h2 class="text-xl font-bold text-center text-green-600 mb-4">üí∞ Carrinho de Capital</h2>
                    <div id="capital-items" class="min-h-[200px] space-y-3">
                        <p class="text-center text-slate-400">Arraste os itens de capital para c√°.</p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modal para Feedback -->
    <div id="feedback-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
        <div class="bg-white p-8 rounded-xl shadow-2xl text-center max-w-sm mx-4">
            <h3 id="modal-title" class="text-2xl font-bold"></h3>
            <p id="modal-message" class="text-slate-600 mt-4 mb-6"></p>
            <button id="modal-close" class="bg-indigo-600 text-white font-semibold py-2 px-6 rounded-lg hover:bg-indigo-700 transition-colors">
                Entendi
            </button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- CONFIGURA√á√ÉO INICIAL ---
            const orcamentoInicial = {
                custeio: 2000.00,
                capital: 3000.00
            };

            let orcamentosAtuais = { ...orcamentoInicial };

            // Lista de itens atualizada com base nas diretrizes do PDDE
            const itens = [
                // --- CUSTEIO (Material de Consumo e Servi√ßos) ---
                { id: 'item-c1', nome: 'Forma√ß√£o de Professores (Workshop)', preco: 600.00, tipo: 'custeio', img: 'https://placehold.co/80x80/E0E0E0/333333?text=Curso' },
                { id: 'item-c2', nome: 'Assinatura Plataforma Digital Educativa', preco: 500.00, tipo: 'custeio', img: 'https://placehold.co/80x80/E0E0E0/333333?text=Digital' },
                { id: 'item-c3', nome: 'Servi√ßos Gr√°ficos (Impress√£o de Apostilas)', preco: 350.00, tipo: 'custeio', img: 'https://placehold.co/80x80/E0E0E0/333333?text=Gr√°fica' },
                { id: 'item-c4', nome: 'Pequeno Reparo El√©trico', preco: 300.00, tipo: 'custeio', img: 'https://placehold.co/80x80/E0E0E0/333333?text=Reparo' },
                { id: 'item-c5', nome: 'Kit para Projeto de Ci√™ncias (Consum√≠veis)', preco: 250.00, tipo: 'custeio', img: 'https://placehold.co/80x80/E0E0E0/333333?text=Ci√™ncia' },
                { id: 'item-c6', nome: 'Tintas para Pintura de Sala de Aula', preco: 400.00, tipo: 'custeio', img: 'https://placehold.co/80x80/E0E0E0/333333?text=Pintura' },
                { id: 'item-c7', nome: 'Material de Expediente Completo', preco: 200.00, tipo: 'custeio', img: 'https://placehold.co/80x80/E0E0E0/333333?text=Papelaria' },
                { id: 'item-c8', nome: 'Recarga de Extintores de Inc√™ndio', preco: 150.00, tipo: 'custeio', img: 'https://placehold.co/80x80/E0E0E0/333333?text=Seguran√ßa' },
                { id: 'item-c9', nome: 'Material de Limpeza e Higiene', preco: 300.00, tipo: 'custeio', img: 'https://placehold.co/80x80/E0E0E0/333333?text=Limpeza' },
                { id: 'item-c10', nome: 'Insumos para Cozinha (G√°s, etc)', preco: 250.00, tipo: 'custeio', img: 'https://placehold.co/80x80/E0E0E0/333333?text=Cozinha' },

                // --- CAPITAL (Material Permanente, Equipamentos e Mobili√°rio) ---
                { id: 'item-k1', nome: 'Computador para Secretaria', preco: 2200.00, tipo: 'capital', img: 'https://placehold.co/80x80/BDBDBD/333333?text=PC' },
                { id: 'item-k2', nome: 'Estante de A√ßo para Biblioteca', preco: 800.00, tipo: 'capital', img: 'https://placehold.co/80x80/BDBDBD/333333?text=Estante' },
                { id: 'item-k3', nome: 'Kit Multim√≠dia (Projetor + Tela)', preco: 1800.00, tipo: 'capital', img: 'https://placehold.co/80x80/BDBDBD/333333?text=Projetor' },
                { id: 'item-k4', nome: 'Bebedouro Industrial', preco: 1200.00, tipo: 'capital', img: 'https://placehold.co/80x80/BDBDBD/333333?text=√Ågua' },
                { id: 'item-k5', nome: 'Kit de Rob√≥tica Educacional (Base)', preco: 1500.00, tipo: 'capital', img: 'https://placehold.co/80x80/BDBDBD/333333?text=Rob√¥' },
                { id: 'item-k6', nome: 'Microsc√≥pio para Laborat√≥rio', preco: 700.00, tipo: 'capital', img: 'https://placehold.co/80x80/BDBDBD/333333?text=Microsc√≥pio' },
                { id: 'item-k7', nome: 'Instrumentos Musicais (Kit Percuss√£o)', preco: 900.00, tipo: 'capital', img: 'https://placehold.co/80x80/BDBDBD/333333?text=M√∫sica' },
                { id: 'item-k8', nome: 'Caixa de Som Amplificada', preco: 600.00, tipo: 'capital', img: 'https://placehold.co/80x80/BDBDBD/333333?text=Som' },
                { id: 'item-k9', nome: 'Mobili√°rio Infantil (5 conjuntos)', preco: 1500.00, tipo: 'capital', img: 'https://placehold.co/80x80/BDBDBD/333333?text=Mesas' },
                { id: 'item-k10', nome: 'Abacos e Material Dourado (conjunto)', preco: 400.00, tipo: 'capital', img: 'https://placehold.co/80x80/BDBDBD/333333?text=Pedag√≥gico' }
            ];

            // --- ELEMENTOS DO DOM ---
            const itensDisponiveisContainer = document.getElementById('itens-disponiveis');
            const dropZones = document.querySelectorAll('.drop-zone');
            const orcamentoCusteioEl = document.getElementById('orcamento-custeio');
            const orcamentoCapitalEl = document.getElementById('orcamento-capital');
            const resetButton = document.getElementById('reset-button');
            const modal = document.getElementById('feedback-modal');
            const modalTitle = document.getElementById('modal-title');
            const modalMessage = document.getElementById('modal-message');
            const modalClose = document.getElementById('modal-close');

            // --- FUN√á√ïES ---
            
            const formatarMoeda = (valor) => {
                return valor.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
            };

            const atualizarDisplayOrcamento = () => {
                orcamentoCusteioEl.textContent = formatarMoeda(orcamentosAtuais.custeio);
                orcamentoCapitalEl.textContent = formatarMoeda(orcamentosAtuais.capital);
                
                orcamentoCusteioEl.classList.toggle('text-red-500', orcamentosAtuais.custeio < 0);
                orcamentoCapitalEl.classList.toggle('text-red-500', orcamentosAtuais.capital < 0);
            };
            
            const mostrarModal = (titulo, mensagem, tipo = 'erro') => {
                modalTitle.textContent = titulo;
                modalMessage.textContent = mensagem;
                
                modalTitle.classList.remove('text-red-500', 'text-green-500');
                if (tipo === 'erro') {
                    modalTitle.classList.add('text-red-500');
                } else if (tipo === 'sucesso') {
                    modalTitle.classList.add('text-green-500');
                }
                
                modal.classList.remove('hidden');
            };

            const carregarItens = () => {
                itensDisponiveisContainer.innerHTML = '';
                const itensEmbaralhados = [...itens].sort(() => Math.random() - 0.5);

                itensEmbaralhados.forEach(item => {
                    const itemEl = document.createElement('div');
                    itemEl.id = item.id;
                    itemEl.className = 'item-card flex items-center p-3 bg-white rounded-lg shadow-sm border border-slate-200 cursor-grab';
                    itemEl.draggable = true;
                    itemEl.innerHTML = `
                        <img src="${item.img}" alt="${item.nome}" class="w-16 h-16 rounded-md mr-4 object-cover">
                        <div class="flex-1">
                            <p class="font-semibold text-slate-800">${item.nome}</p>
                            <p class="text-sm text-slate-500">${formatarMoeda(item.preco)}</p>
                        </div>
                    `;
                    itensDisponiveisContainer.appendChild(itemEl);
                });
                adicionarEventListenersItens();
            };
            
            const verificarFimDeJogo = () => {
                const itensRestantes = itensDisponiveisContainer.children.length;
                if (itensRestantes > 0) return;

                let mensagemFinal;
                let tituloFinal;
                let tipoModal;

                if (orcamentosAtuais.custeio >= 0 && orcamentosAtuais.capital >= 0) {
                    tituloFinal = 'Parab√©ns! üéâ';
                    mensagemFinal = 'Voc√™ alocou todos os itens corretamente e ficou dentro dos dois or√ßamentos. Excelente gest√£o financeira!';
                    tipoModal = 'sucesso';
                     if(orcamentosAtuais.custeio === 0 && orcamentosAtuais.capital === 0){
                        mensagemFinal += ' E ainda conseguiu zerar os or√ßamentos, resultado perfeito!'
                    }
                } else {
                     // Esta condi√ß√£o n√£o deve ser alcan√ßada por causa da valida√ß√£o no drop, mas fica como seguran√ßa.
                    tituloFinal = 'Quase l√°! üò¨';
                    mensagemFinal = 'Voc√™ alocou todos os itens, mas pelo menos um dos or√ßamentos foi estourado. Tente novamente para um resultado perfeito!';
                    tipoModal = 'erro';
                }
                mostrarModal(tituloFinal, mensagemFinal, tipoModal);
            };

            // --- L√ìGICA DE DRAG AND DROP ---

            function handleDragStart(e) {
                e.dataTransfer.setData('text/plain', e.target.id);
                e.target.classList.add('dragging');
            }

            function handleDragEnd(e) {
                e.target.classList.remove('dragging');
            }

            function handleDragOver(e) {
                e.preventDefault();
                this.classList.add('drag-over');
            }

            function handleDragLeave(e) {
                this.classList.remove('drag-over');
            }

            function handleDrop(e) {
                e.preventDefault();
                this.classList.remove('drag-over');

                const idItemArrastado = e.dataTransfer.getData('text/plain');
                const itemArrastadoEl = document.getElementById(idItemArrastado);
                
                if (!itemArrastadoEl || itemArrastadoEl.parentElement !== itensDisponiveisContainer) return;

                const itemData = itens.find(i => i.id === idItemArrastado);
                const tipoCarrinho = this.dataset.tipo;

                if (itemData.tipo !== tipoCarrinho) {
                    mostrarModal('Carrinho Errado!', `O item "${itemData.nome}" √© uma despesa de ${itemData.tipo}, n√£o de ${tipoCarrinho}.`, 'erro');
                    return;
                }
                
                // Valida√ß√£o para n√£o permitir or√ßamento negativo
                if (itemData.preco > orcamentosAtuais[tipoCarrinho]) {
                    mostrarModal('Or√ßamento Insuficiente!', `Adicionar "${itemData.nome}" deixaria o saldo de ${tipoCarrinho} negativo. Opera√ß√£o cancelada.`, 'erro');
                    return;
                }

                orcamentosAtuais[tipoCarrinho] -= itemData.preco;
                atualizarDisplayOrcamento();

                const containerDestino = document.getElementById(`${tipoCarrinho}-items`);
                const placeholder = containerDestino.querySelector('p');
                if (placeholder) placeholder.remove();
                
                containerDestino.appendChild(itemArrastadoEl);
                itemArrastadoEl.draggable = false;
                itemArrastadoEl.className = 'item-card flex items-center p-3 bg-white rounded-lg shadow-sm border border-slate-200 item-in-cart';

                // Verifica se o jogo terminou apenas depois que todos os itens foram alocados
                if(itensDisponiveisContainer.children.length === 0){
                    verificarFimDeJogo();
                }
            }
            
            // --- INICIALIZA√á√ÉO E EVENT LISTENERS ---

            const adicionarEventListenersItens = () => {
                const itensDraggable = document.querySelectorAll('#itens-disponiveis .item-card');
                itensDraggable.forEach(item => {
                    item.addEventListener('dragstart', handleDragStart);
                    item.addEventListener('dragend', handleDragEnd);
                });
            };
            
            dropZones.forEach(zone => {
                zone.addEventListener('dragover', handleDragOver);
                zone.addEventListener('dragleave', handleDragLeave);
                zone.addEventListener('drop', handleDrop);
            });

            modalClose.addEventListener('click', () => modal.classList.add('hidden'));

            const reiniciarAtividade = () => {
                orcamentosAtuais = { ...orcamentoInicial };
                atualizarDisplayOrcamento();

                document.getElementById('custeio-items').innerHTML = '<p class="text-center text-slate-400">Arraste os itens de custeio para c√°.</p>';
                document.getElementById('capital-items').innerHTML = '<p class="text-center text-slate-400">Arraste os itens de capital para c√°.</p>';

                carregarItens();
            };
            
            resetButton.addEventListener('click', reiniciarAtividade);

            reiniciarAtividade();
        });
    </script>
</body>
</html>

